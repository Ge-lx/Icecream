{"version":3,"sources":["main.js"],"names":["CONFIG","env","process","NODE_ENV","root","__dirname","port","vueOptions","rootPath","join","head","styles","style","metas","name","content","app","locals","ENV","ENV_DEVELOPMENT","ROOT_PATH","console","log","init","Promise","resolve","reject","server","createServer","startServer","listen","on","then","pid","catch","error","syscall","code","err","bind_port","exit"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,SAAS;AACbC,OAAKC,QAAQD,GAAR,CAAYE,QAAZ,IAAwB,aADhB;AAEbC,QAAMC,SAFO;AAGbC,QAAM,IAHO;AAIbC,cAAY;AACVC,cAAU,eAAKC,IAAL,CAAUJ,SAAV,EAAqB,QAArB,CADA;AAEV;AACAK,UAAM;AACJC,cAAQ,CAAC,EAAEC,OAAO,kBAAT,EAAD,CADJ;AAEJC,aAAO,CACL,EAAEC,MAAM,UAAR,EAAoBC,SAAS,uCAA7B,EADK;AAFH;AAHI;AAJC,CAAf;;AAgBA,IAAIC,MAAM,wBAAV;;AAEAA,IAAIC,MAAJ,CAAWC,GAAX,GAAiBlB,OAAOC,GAAxB;AACAe,IAAIC,MAAJ,CAAWE,eAAX,GAA8BnB,OAAOC,GAAP,KAAe,aAA7C;AACAe,IAAIC,MAAJ,CAAWT,QAAX,GAAsBN,QAAQD,GAAR,CAAYmB,SAAlC;;AAEAC,QAAQC,GAAR,CAAY,0CAAZ;AACA,iBAAOC,IAAP,CAAYP,GAAZ,EAAiBhB,MAAjB;AACAqB,QAAQC,GAAR,CAAY,SAAZ;;AAEA;AACAD,QAAQC,GAAR,CAAY,yBAAZ;;AAEA,IAAIE,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC/B,MAAIC,SAAS,eAAKC,YAAL,CAAkBZ,GAAlB,CAAb;;AAEA,sBAAUa,WAAV,CAAsBF,MAAtB,EAA8B3B,MAA9B,EAH+B,CAGO;;AAEtC2B,SAAOG,MAAP,CAAc9B,OAAOM,IAArB;AACAqB,SAAOI,EAAP,CAAU,OAAV,EAAmBL,MAAnB;AACAC,SAAOI,EAAP,CAAU,WAAV,EAAuBN,OAAvB;AACD,CARD,EAQGO,IARH,CAQQ,YAAM;AACZX,UAAQC,GAAR,aAAsBpB,QAAQ+B,GAA9B,mBAA+CjC,OAAOC,GAAtD,8BAAkFD,OAAOM,IAAzF;AACD,CAVD,EAUG4B,KAVH,CAUS,UAACC,KAAD,EAAW;AAClB,MAAIA,MAAMC,OAAN,KAAkB,QAAtB,EAAgC;AAC9B,UAAMD,KAAN;AACD;AACD;AACA,UAAQA,MAAME,IAAd;AACE,SAAK,QAAL;AACEhB,cAAQiB,GAAR,CAAY,UAAUtC,OAAOuC,SAAjB,GAA6B,+BAAzC;AACArC,cAAQsC,IAAR,CAAa,CAAb;AACF,SAAK,YAAL;AACEnB,cAAQiB,GAAR,CAAY,UAAUtC,OAAOuC,SAAjB,GAA6B,oBAAzC;AACArC,cAAQsC,IAAR,CAAa,CAAb;AACF;AACE,YAAML,KAAN;AARJ;AAUD,CAzBD","file":"main.js","sourcesContent":["import express from 'express'\r\nimport path from 'path'\r\nimport http from 'http'\r\nimport router from './router'\r\nimport websocket from './net/websocket.js'\r\n\r\nconst CONFIG = {\r\n  env: process.env.NODE_ENV || 'development',\r\n  root: __dirname,\r\n  port: 8080,\r\n  vueOptions: {\r\n    rootPath: path.join(__dirname, 'routes'),\r\n    // vueVersion: '2.5.13',\r\n    head: {\r\n      styles: [{ style: 'static/style.css' }],\r\n      metas: [\r\n        { name: 'viewport', content: 'width=device-width, initial-scale=1.0' }\r\n      ]\r\n    }\r\n  }\r\n}\r\n\r\nvar app = express()\r\n\r\napp.locals.ENV = CONFIG.env\r\napp.locals.ENV_DEVELOPMENT = (CONFIG.env === 'development')\r\napp.locals.rootPath = process.env.ROOT_PATH\r\n\r\nconsole.log('Initializing app. Loading componentes...')\r\nrouter.init(app, CONFIG)\r\nconsole.log('Loaded.')\r\n\r\n// -------------------------BEGIN WEBSOCKET SETUP-------------\r\nconsole.log('Starting HTTP Server...')\r\n\r\nnew Promise((resolve, reject) => {\r\n  let server = http.createServer(app)\r\n\r\n  websocket.startServer(server, CONFIG) // Starting Websocket server\r\n\r\n  server.listen(CONFIG.port)\r\n  server.on('error', reject)\r\n  server.on('listening', resolve)\r\n}).then(() => {\r\n  console.log(`Worker ${process.pid} running a ${CONFIG.env} server. Listening on ${CONFIG.port}`)\r\n}).catch((error) => {\r\n  if (error.syscall !== 'listen') {\r\n    throw error\r\n  }\r\n  // handle specific listen errors with friendly messages\r\n  switch (error.code) {\r\n    case 'EACCES':\r\n      console.err('Port ' + CONFIG.bind_port + ' requires elevated privileges')\r\n      process.exit(1)\r\n    case 'EADDRINUSE':\r\n      console.err('Port ' + CONFIG.bind_port + ' is already in use')\r\n      process.exit(1)\r\n    default:\r\n      throw error\r\n  }\r\n})\r\n"]}